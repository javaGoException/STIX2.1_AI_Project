Question ID,AttackSeq ID,Batch ID,Question,A,B,C,D,Key Points,Context,Ground Truth,Source,Unshuffled Choices
2,1,1-Execution-T1106-Native API,"Before SectorB06 achieved persistence by adding malicious files like RasTls.dll and IntelGraphicsController.exe to the registry run keys, which ATT&CK technique most likely occurred as the malware manipulated file ownership using CreateProcess and deleted initial traces such as winword.exe?",T1564.012-File/Path Exclusions,T1106-Native API,T1057-Process Discovery,T1053.002-At,"Execution: The first-stage malware, identified as RasTls.dll, begins by resolving encoded API addresses and then starts a thread to poll for the presence of a debugger, exiting if one is found. It uses a custom hashing algorithm to check the process name it is running under against a list of expected names, including 'winword.exe', 'excel.exe', 'powerpnt.exe', 'acrord32.exe', and 'eqnedt32.exe'. The malware also runs CreateProcess with commands to manipulate file ownership and drops batch files to delete the initial malware file and winword.exe.","Initial Access: On April 30, 2019, the ThreatRecon Team reported that SectorB06, a state-sponsored threat actor group, has been exploiting vulnerabilities in Microsoft Office's Equation Editor, specifically a highly obfuscated version of CVE-2017-11882. The group targeted organizations by using a Mongolian language decoy document referencing the Ministry of Justice and Internal Affairs of Mongolia. The document was uploaded from a Singapore IP address and was designed to drop first-stage malware if the exploit was successful.
Persistence: The malware achieves persistence by decompressing and dropping two files: RasTls.dll (renamed from cclerr.wll) and IntelGraphicsController.exe/AcroRd32.exe, which is a legitimate signed Symantec file (real name: dot1xtra.exe). These files are stored in directories related to Intel Processor Graphics and are added to the registry run keys for persistence. The registry key used is 'IntelGraphicsController' with a specific value format.
Defense Evasion: The malware employs several defense evasion techniques, including checking for debuggers, process name hashing, and process injection. It also uses timestomping to modify the timestamps of its dropped files to approximate those of kernel32.dll. Additionally, the malware impersonates a legitimate Symantec executable file to avoid detection.
Discovery: The malware performs discovery by querying the registry and identifying victim machines using a specific registry key under 'Software\Intel\Java'. It also checks for the presence of certain processes on the system.
Command and Control: The second-stage malware, which was not analyzed in detail, is designed to create a remote command shell and communicates with external C2 IP addresses on port 443. It also references internal IP addresses, indicating that the threat actor already has basic access to the victim's internal network.
Others: The CTI report from ThreatRecon Team on May 27, 2019, provides an overview of the activities of SectorB06, a state-sponsored threat actor group active in Asia. The report includes details on the malware used, the exploitation of vulnerabilities, persistence mechanisms, defense evasion tactics, discovery processes, and command and control infrastructure. Additionally, the report lists MITRE ATT&CK Techniques observed in the analysis of the malware and provides indicators of compromise, including hashes and IP addresses.",T1106-Native API,SectorB06 using Mongolian language in lure document,"T1106-Native API, T1053.002-At, T1057-Process Discovery, T1564.012-File/Path Exclusions"
5,1,1-Defense Evasion-T1622-Debugger Evasion,"After gaining initial access through an exploit in Microsoft Office's Equation Editor, which ATT&CK technique most likely occurred before the malware modified timestamps of its dropped files to mimic kernel32.dll using timestomping?",T1622-Debugger Evasion,T1562.009-Safe Mode Boot,T1574.010-Services File Permissions Weakness,T1547-Boot or Logon Autostart Execution,"Defense Evasion: The malware employs several defense evasion techniques, including checking for debuggers, process name hashing, and process injection. It also uses timestomping to modify the timestamps of its dropped files to approximate those of kernel32.dll. Additionally, the malware impersonates a legitimate Symantec executable file to avoid detection.","Initial Access: On April 30, 2019, the ThreatRecon Team reported that SectorB06, a state-sponsored threat actor group, has been exploiting vulnerabilities in Microsoft Office's Equation Editor, specifically a highly obfuscated version of CVE-2017-11882. The group targeted organizations by using a Mongolian language decoy document referencing the Ministry of Justice and Internal Affairs of Mongolia. The document was uploaded from a Singapore IP address and was designed to drop first-stage malware if the exploit was successful.
Execution: The first-stage malware, identified as RasTls.dll, begins by resolving encoded API addresses and then starts a thread to poll for the presence of a debugger, exiting if one is found. It uses a custom hashing algorithm to check the process name it is running under against a list of expected names, including 'winword.exe', 'excel.exe', 'powerpnt.exe', 'acrord32.exe', and 'eqnedt32.exe'. The malware also runs CreateProcess with commands to manipulate file ownership and drops batch files to delete the initial malware file and winword.exe.
Persistence: The malware achieves persistence by decompressing and dropping two files: RasTls.dll (renamed from cclerr.wll) and IntelGraphicsController.exe/AcroRd32.exe, which is a legitimate signed Symantec file (real name: dot1xtra.exe). These files are stored in directories related to Intel Processor Graphics and are added to the registry run keys for persistence. The registry key used is 'IntelGraphicsController' with a specific value format.
Discovery: The malware performs discovery by querying the registry and identifying victim machines using a specific registry key under 'Software\Intel\Java'. It also checks for the presence of certain processes on the system.
Command and Control: The second-stage malware, which was not analyzed in detail, is designed to create a remote command shell and communicates with external C2 IP addresses on port 443. It also references internal IP addresses, indicating that the threat actor already has basic access to the victim's internal network.
Others: The CTI report from ThreatRecon Team on May 27, 2019, provides an overview of the activities of SectorB06, a state-sponsored threat actor group active in Asia. The report includes details on the malware used, the exploitation of vulnerabilities, persistence mechanisms, defense evasion tactics, discovery processes, and command and control infrastructure. Additionally, the report lists MITRE ATT&CK Techniques observed in the analysis of the malware and provides indicators of compromise, including hashes and IP addresses.",T1622-Debugger Evasion,SectorB06 using Mongolian language in lure document,"T1622-Debugger Evasion, T1562.009-Safe Mode Boot, T1547-Boot or Logon Autostart Execution, T1574.010-Services File Permissions Weakness"
